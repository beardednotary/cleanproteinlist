<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Protein Powder Safety Report | Clean Protein List</title>
    <meta name="description" content="Your personalized protein powder safety report based on Consumer Reports October 2025 testing. See if your brand is safe and get verified alternatives.">
    <link rel="stylesheet" href="style.css">
    <style>
        /* Results Page Styles */
        .results-container {
            max-width: 900px;
            margin: 60px auto;
            padding: 40px 20px;
        }

        .result-header {
            text-align: center;
            margin-bottom: 50px;
        }

        .result-header h1 {
            font-size: 36px;
            color: #333;
            margin-bottom: 15px;
        }

        .result-summary {
            font-size: 20px;
            color: #666;
            margin-bottom: 10px;
        }

        /* Brand Result Card */
        .brand-result-card {
            background: white;
            border-radius: 12px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .brand-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .brand-header h2 {
            font-size: 28px;
            color: #333;
            margin: 0;
        }

        .rank-badge {
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: 700;
            font-size: 15px;
        }

        .rank-safe {
            background: #d4edda;
            color: #155724;
        }

        .rank-moderate {
            background: #fff3cd;
            color: #856404;
        }

        .rank-bad {
            background: #f8d7da;
            color: #721c24;
        }

        .safety-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .safety-stat {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }

        .safety-stat-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
        }

        .safety-stat-value {
            font-size: 20px;
            font-weight: 700;
            color: #333;
        }

        .safety-stat-value.safe { color: #2ecc71; }
        .safety-stat-value.moderate { color: #f39c12; }
        .safety-stat-value.bad { color: #e74c3c; }

        .article-link {
            display: inline-block;
            margin-top: 20px;
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
            font-size: 16px;
        }

        .article-link:hover {
            text-decoration: underline;
        }

        /* Recommendations Section */
        .recommendations-section {
            margin: 50px 0;
        }

        .recommendations-section h2 {
            font-size: 28px;
            color: #333;
            margin-bottom: 30px;
            text-align: center;
        }

        .recommendations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
        }

        .rec-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 25px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .rec-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .rec-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 15px;
            gap: 10px;
        }

        .rec-header h3 {
            font-size: 19px;
            color: #333;
            margin: 0;
            line-height: 1.3;
        }

        .rec-rank {
            background: #d4edda;
            color: #155724;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 13px;
            font-weight: 700;
            white-space: nowrap;
        }

        .rec-details {
            margin: 15px 0;
        }

        .rec-detail {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            font-size: 14px;
            border-bottom: 1px solid #f0f0f0;
        }

        .rec-detail:last-child {
            border-bottom: none;
        }

        .rec-detail-label {
            color: #666;
            font-weight: 500;
        }

        .rec-detail-value {
            color: #333;
            font-weight: 600;
            text-align: right;
        }

        .amazon-btn {
            display: block;
            width: 100%;
            background: #FF9900;
            color: white;
            text-align: center;
            padding: 12px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 600;
            margin-top: 15px;
            transition: background 0.3s;
        }

        .amazon-btn:hover {
            background: #e88700;
        }

        .rec-article-link {
            display: block;
            text-align: center;
            margin-top: 10px;
            color: #667eea;
            text-decoration: none;
            font-size: 14px;
        }
        .rec-article-link:hover {
text-decoration: underline;
}
/* Action Steps */
    .action-steps {
        background: white;
        border-radius: 12px;
        padding: 40px;
        margin: 40px 0;
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }

    .action-steps h2 {
        font-size: 28px;
        color: #333;
        margin-bottom: 25px;
    }

    .action-steps ol {
        margin-left: 25px;
    }

    .action-steps li {
        margin-bottom: 20px;
        line-height: 1.7;
        font-size: 16px;
        color: #444;
    }

    .action-steps strong {
        color: #333;
    }

    /* CTA Boxes */
    .cta-box {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 50px 40px;
        border-radius: 12px;
        text-align: center;
        margin: 50px 0;
    }

    .cta-box h2 {
        font-size: 30px;
        margin-bottom: 15px;
        color: white;
    }

    .cta-box p {
        font-size: 18px;
        margin-bottom: 30px;
        opacity: 0.95;
        color: white;
    }

    .cta-button {
        display: inline-block;
        background: white;
        color: #667eea;
        padding: 15px 40px;
        border-radius: 8px;
        text-decoration: none;
        font-weight: 700;
        font-size: 18px;
        transition: transform 0.2s;
    }

    .cta-button:hover {
        transform: scale(1.05);
    }

    .secondary-btn {
        display: inline-block;
        background: white;
        color: #667eea;
        border: 2px solid #667eea;
        padding: 12px 30px;
        border-radius: 8px;
        text-decoration: none;
        font-weight: 600;
        margin-top: 20px;
        transition: all 0.3s;
    }

    .secondary-btn:hover {
        background: #667eea;
        color: white;
    }

    /* Warning Box */
    .warning-box {
        background: #fff3cd;
        border-left: 5px solid #ffc107;
        padding: 25px;
        margin: 30px 0;
        border-radius: 4px;
    }

    .warning-box h3 {
        color: #856404;
        margin-top: 0;
    }

    @media (max-width: 768px) {
        .results-container {
            padding: 20px;
        }
        .brand-result-card, .action-steps {
            padding: 25px;
        }
        .recommendations-grid {
            grid-template-columns: 1fr;
        }
        .safety-grid {
            grid-template-columns: 1fr;
        }
    }
</style>
</head>
<body>
    <header>
        <div class="container">
            <a href="index.html" class="logo">Clean Protein List</a>
            <nav>
                <a href="index.html">Home</a>
                <a href="quiz.html">Take Quiz</a>
                <a href="blog/lead-in-protein-powder-list.html">Full Report</a>
            </nav>
        </div>
    </header>
    <main class="results-container">
    <div class="result-header">
        <h1>Your Protein Powder Safety Report</h1>
        <p class="result-summary" id="result-summary"></p>
    </div>

    <!-- Brand Result Card -->
    <div class="brand-result-card" id="brand-result">
        <!-- Populated by JavaScript -->
    </div>

    <!-- Recommendations Section -->
    <section class="recommendations-section">
        <h2>✅ Verified Safe Alternatives</h2>
        <div class="recommendations-grid" id="recommendations">
            <!-- Populated by JavaScript -->
        </div>
    </section>

    <!-- Action Steps -->
    <div class="action-steps">
        <h2>What You Should Do Next:</h2>
        <ol id="action-list">
            <!-- Populated by JavaScript -->
        </ol>
    </div>

    <!-- Full Report CTA -->
    <div class="cta-box">
        <h2>📊 See Complete Rankings</h2>
        <p>View all 23 products tested by Consumer Reports, ranked from safest to most contaminated.</p>
        <a href="blog/lead-in-protein-powder-list.html" class="cta-button">View Full Report →</a>
    </div>

    <!-- Retake Quiz -->
    <div style="text-align: center; margin: 40px 0;">
        <a href="quiz.html" class="secondary-btn">Check Another Brand</a>
    </div>
</main>

<footer>
    <div class="container">
        <p>&copy; 2025 Clean Protein List. Based on Consumer Reports October 2025 testing.</p>
        <p><a href="index.html">Home</a> | <a href="quiz.html">Take Quiz</a> | <a href="blog/lead-in-protein-powder-list.html">Full Report</a></p>
    </div>
</footer>

<script>
    // Complete Product Database (Consumer Reports + Clean Label Project)
    const proteinProducts = [
        // CONSUMER REPORTS TESTED - SAFE (Rank 1-7)
        {
            rank: 1,
            brand: "MuscleTech",
            fullName: "MuscleTech 100% Mass Gainer",
            leadLevel: "Not detected",
            maxServings: "No limit",
            guidance: "Better for daily consumption",
            type: "Whey-based mass gainer",
            bestFor: "Bulking, mass gaining, hardgainers",
            price: "$3/serving",
            source: "Consumer Reports",
            amazonLink: "https://amzn.to/3IZsKsr",
            articleLink: "blog/muscletech-mass-gainer-safety.html"
        },
        {
            rank: 2,
            brand: "Dymatize",
            fullName: "Dymatize Super Mass Gainer",
            leadLevel: "Below detection limits",
            maxServings: "4 per day",
            guidance: "Better for daily consumption",
            type: "Whey-based mass gainer",
            bestFor: "Mass gaining, bulking",
            price: "$3/serving",
            source: "Consumer Reports",
            amazonLink: "https://amzn.to/3Wl18B2",
            articleLink: null
        },
        {
            rank: 3,
            brand: "Momentous",
            fullName: "Momentous Whey Protein Isolate",
            leadLevel: "Below detection limits",
            maxServings: "3⅓ per day",
            guidance: "Better for daily consumption",
            type: "Whey isolate (NSF Certified)",
            bestFor: "Athletes, drug-tested sports",
            price: "$2.50/serving",
            source: "Consumer Reports",
            amazonLink: "https://amzn.to/43tzmpF",
            articleLink: "blog/momentous-protein-safety-analysis.html"
        },
        {
            rank: 4,
            brand: "BSN",
            fullName: "BSN Syntha-6 Protein Powder",
            leadLevel: "Below detection limits",
            maxServings: "2 per day",
            guidance: "Better for daily consumption",
            type: "Multi-source whey blend",
            bestFor: "Taste, post-workout recovery",
            price: "$1.50/serving",
            source: "Consumer Reports",
            amazonLink: "https://amzn.to/4oz7nNu",
            articleLink: "blog/bsn-syntha-6-safety-analysis.html"
        },
        {
            rank: 5,
            brand: "Optimum Nutrition",
            fullName: "Optimum Nutrition Gold Standard 100% Whey",
            leadLevel: "Below detection limits",
            maxServings: "1¾ per day",
            guidance: "Better for daily consumption",
            type: "Whey blend",
            bestFor: "Best value, most popular",
            price: "$0.75/serving",
            source: "Consumer Reports",
            amazonLink: "https://amzn.to/4hpjiuZ",
            articleLink: null
        },
        {
            rank: 6,
            brand: "Transparent Labs",
            fullName: "Transparent Labs Mass Gainer",
            leadLevel: "Below detection limits",
            maxServings: "1 per day",
            guidance: "Better for daily consumption",
            type: "Whey-based mass gainer",
            bestFor: "Clean bulking, transparency",
            price: "$3.50/serving",
            source: "Consumer Reports",
            amazonLink: "https://amzn.to/49hvX0U",
            articleLink: null
        },
        {
            rank: 7,
            brand: "OWYN",
            fullName: "OWYN Pro Elite High Protein Shake",
            leadLevel: "Below detection limits",
            maxServings: "1 per day",
            guidance: "Better for daily consumption",
            type: "Plant-based (pea protein)",
            bestFor: "Vegans - ONLY safe plant option",
            price: "$3/serving",
            source: "Consumer Reports",
            amazonLink: "https://amzn.to/4nqF7vD",
            articleLink: null
        },
        // CLEAN LABEL PROJECT - CLEAN SIXTEEN (Not CR tested but verified safe)
        {
            rank: null,
            brand: "Body Fortress",
            fullName: "Body Fortress Super Advanced Whey Protein",
            leadLevel: "Below detection limits",
            maxServings: "No limit",
            guidance: "Clean Label certified",
            type: "Whey concentrate",
            bestFor: "Budget option, widely available",
            price: "$0.67/serving",
            source: "Clean Label Project",
            amazonLink: "https://amzn.to/42WDFd4",
            articleLink: null
        },
        {
            rank: null,
            brand: "Isopure",
            fullName: "Isopure Zero Carb Protein Powder",
            leadLevel: "Below detection limits",
            maxServings: "No limit",
            guidance: "Clean Label certified",
            type: "Whey isolate",
            bestFor: "Low-carb, keto diets",
            price: "$1.50/serving",
            source: "Clean Label Project",
            amazonLink: "https://amzn.to/4njLNLQ",
            articleLink: null
        },
        // CONSUMER REPORTS - MODERATE (Rank 8-19)
        {
            rank: 12,
            brand: "Orgain",
            fullName: "Orgain Organic Plant-Based Protein",
            leadLevel: "143% over limit",
            maxServings: "4¾ per week",
            guidance: "Okay occasionally",
            type: "Plant-based",
            bestFor: "Occasional use only",
            price: "$2/serving",
            source: "Consumer Reports",
            amazonLink: null,
            articleLink: null
        },
        {
            rank: 16,
            brand: "Vega",
            fullName: "Vega Premium Sport Plant-Based Protein",
            leadLevel: "185% over limit",
            maxServings: "3¾ per week",
            guidance: "Okay occasionally",
            type: "Plant-based",
            bestFor: "Occasional use only",
            price: "$2.50/serving",
            source: "Consumer Reports",
            amazonLink: null,
            articleLink: null
        },
        {
            rank: 9,
            brand: "Muscle Milk",
            fullName: "Muscle Milk Pro Advanced Nutrition",
            leadLevel: "128% over limit",
            maxServings: "5½ per week",
            guidance: "Okay occasionally",
            type: "RTD shake",
            bestFor: "Occasional use only",
            price: "$2/serving",
            source: "Consumer Reports",
            amazonLink: null,
            articleLink: null
        },
        {
            rank: 10,
            brand: "Ensure",
            fullName: "Ensure Plant-Based Protein Shake",
            leadLevel: "132% over limit",
            maxServings: "5⅓ per week",
            guidance: "Okay occasionally",
            type: "Plant-based RTD",
            bestFor: "Occasional use only",
            price: "$2/serving",
            source: "Consumer Reports",
            amazonLink: null,
            articleLink: null
        },
        // HIGH RISK (Rank 20-21)
        {
            rank: 20,
            brand: "Momentous Plant",
            fullName: "Momentous 100% Plant Protein",
            leadLevel: "476% over limit",
            maxServings: "1½ per week",
            guidance: "Limit to once per week",
            type: "Plant-based",
            bestFor: "Not recommended",
            price: "$2.50/serving",
            source: "Consumer Reports",
            amazonLink: null,
            articleLink: null
        },
        {
            rank: 21,
            brand: "Garden of Life",
            fullName: "Garden of Life Sport Organic Plant-Based",
            leadLevel: "564% over limit",
            maxServings: "1¼ per week",
            guidance: "Limit to once per week",
            type: "Plant-based",
            bestFor: "Not recommended",
            price: "$2.50/serving",
            source: "Consumer Reports",
            amazonLink: null,
            articleLink: null
        },
        // WORST (Rank 22-23)
        {
            rank: 22,
            brand: "Huel",
            fullName: "Huel Black Edition",
            leadLevel: "1,288% over limit (6.44 µg)",
            maxServings: "0 per week",
            guidance: "AVOID",
            type: "Plant-based meal replacement",
            bestFor: "Do not use",
            price: "$3/serving",
            source: "Consumer Reports",
            amazonLink: null,
            articleLink: "blog/huel-black-edition-lead-content.html"
        },
        {
            rank: 23,
            brand: "Naked Nutrition",
            fullName: "Naked Nutrition Vegan Mass Gainer",
            leadLevel: "1,572% over limit (7.86 µg)",
            maxServings: "0 per week",
            guidance: "AVOID",
            type: "Plant-based mass gainer",
            bestFor: "Do not use",
            price: "$2.50/serving",
            source: "Consumer Reports",
            amazonLink: null,
            articleLink: "blog/naked-nutrition-vegan-mass-gainer-lead.html"
        }
    ];

    // Get quiz data from sessionStorage
    const quizData = JSON.parse(sessionStorage.getItem('quizAnswers'));

    // If no quiz data, redirect back to quiz
    if (!quizData) {
        window.location.href = 'quiz.html';
    } else {
        // Generate results on page load
        window.addEventListener('DOMContentLoaded', generateResults);
    }

    function generateResults() {
        const brandName = quizData.currentBrandName.toLowerCase().trim();
        
        // Try to find their brand in database
        let matchedProduct = null;
        
        // First try exact or partial brand match
        for (let product of proteinProducts) {
            const productBrand = product.brand.toLowerCase();
            const productFull = product.fullName.toLowerCase();
            
            if (brandName.includes(productBrand) || 
                productBrand.includes(brandName) ||
                brandName.includes(productFull) ||
                productFull.includes(brandName)) {
                matchedProduct = product;
                break;
            }
        }
        
        // Special case handling for common variations
        if (!matchedProduct) {
            if (brandName.includes('naked')) {
                matchedProduct = proteinProducts.find(p => p.rank === 23);
            } else if (brandName.includes('huel')) {
                matchedProduct = proteinProducts.find(p => p.rank === 22);
            } else if (brandName.includes('momentous') && brandName.includes('plant')) {
                matchedProduct = proteinProducts.find(p => p.rank === 20);
            } else if (brandName.includes('garden')) {
                matchedProduct = proteinProducts.find(p => p.rank === 21);
            } else if (brandName.includes('body fortress')) {
                matchedProduct = proteinProducts.find(p => p.brand === 'Body Fortress');
            } else if (brandName.includes('isopure')) {
                matchedProduct = proteinProducts.find(p => p.brand === 'Isopure');
            }
        }
        
        if (matchedProduct) {
            displayKnownBrand(matchedProduct);
        } else {
            displayUnknownBrand(quizData.currentBrandName);
        }
    }

    function displayKnownBrand(product) {
        const summary = document.getElementById('result-summary');
        const brandResult = document.getElementById('brand-result');
        
        // Set summary based on safety
        if (product.rank && product.rank <= 7) {
            summary.innerHTML = `<span style="color: #2ecc71; font-weight: 600;">✅ Good news!</span> ${product.brand} is one of the safer options tested.`;
        } else if (!product.rank && product.source === 'Clean Label Project') {
            summary.innerHTML = `<span style="color: #2ecc71; font-weight: 600;">✅ Good news!</span> ${product.brand} is Clean Label Project certified as safe.`;
        } else if (product.rank && product.rank <= 19) {
            summary.innerHTML = `<span style="color: #f39c12; font-weight: 600;">⚠️ Use with caution.</span> ${product.brand} has elevated heavy metal levels.`;
        } else {
            summary.innerHTML = `<span style="color: #e74c3c; font-weight: 600;">🚫 Important warning.</span> ${product.brand} has dangerous contamination levels.`;
        }
        
        // Build result card
        const rankBadgeClass = product.rank && product.rank <= 7 ? 'rank-safe' : 
                               product.rank && product.rank <= 19 ? 'rank-moderate' : 
                               product.rank ? 'rank-bad' : 'rank-safe';
        
        const rankText = product.rank ? `Rank: #${product.rank} of 23` : 'Clean Label Certified';
        
        brandResult.innerHTML = `
            <div class="brand-header">
                <h2>${product.fullName}</h2>
                <div class="rank-badge ${rankBadgeClass}">${rankText}</div>
            </div>
            
            <div class="safety-grid">
                <div class="safety-stat">
                    <div class="safety-stat-label">Lead Level</div>
                    <div class="safety-stat-value ${product.rank && product.rank <= 7 ? 'safe' : product.rank && product.rank <= 19 ? 'moderate' : product.rank ? 'bad' : 'safe'}">
                        ${product.leadLevel}
                    </div>
                </div>
                <div class="safety-stat">
                    <div class="safety-stat-label">Max Servings</div>
                    <div class="safety-stat-value">${product.maxServings}</div>
                </div>
                <div class="safety-stat">
                    <div class="safety-stat-label">CR Guidance</div>
                    <div class="safety-stat-value">${product.guidance}</div>
                </div>
                <div class="safety-stat">
                    <div class="safety-stat-label">Best For</div>
                    <div class="safety-stat-value">${product.bestFor}</div>
                </div>
            </div>
            
            ${product.articleLink ? `
                <a href="${product.articleLink}" class="article-link">
                    Read Full ${product.brand} Analysis →
                </a>
            ` : ''}
        `;
        
        // Generate recommendations
        generateRecommendations(product);
        
        // Generate action steps
        generateActionSteps(product);
    }

    function displayUnknownBrand(brandName) {
        const summary = document.getElementById('result-summary');
        const brandResult = document.getElementById('brand-result');
        
        summary.innerHTML = `<span style="color: #f39c12; font-weight: 600;">⚠️ Brand not tested.</span> ${brandName} was not included in Consumer Reports or Clean Label Project testing.`;
        
        brandResult.innerHTML = `
            <div class="brand-header">
                <h2>${brandName}</h2>
                <div class="rank-badge rank-moderate">Not Tested</div>
            </div>
            
            <div class="warning-box">
                <h3>⚠️ This Brand Has Not Been Independently Verified</h3>
                <p><strong>Without third-party testing, we cannot verify the safety of this product.</strong> Many untested brands may have contamination similar to or worse than products that failed Consumer Reports testing.</p>
                
                <p style="margin-top: 20px;"><strong>What to look for if you want to keep using this brand:</strong></p>
                <ul style="margin-left: 20px; line-height: 1.8;">
                    <li><strong>NSF Certified for Sport</strong> - Tests every batch for heavy metals</li>
                    <li><strong>Clean Label Project certification</strong> - Independent contamination testing</li>
                    <li><strong>Informed Choice</strong> - Batch testing program</li>
                </ul>
                
                <p style="margin-top: 20px;"><strong>Our recommendation:</strong> Switch to a verified-safe option below. Don't gamble with unverified products when tested alternatives exist.</p>
            </div>
        `;
        
        // Show all safe alternatives
        generateRecommendations(null);
        generateActionSteps(null);
    }

    function generateRecommendations(currentProduct) {
        const recsDiv = document.getElementById('recommendations');
        
        // Get safe products (CR ranks 1-7 + Clean Label certified)
        let safeProducts = proteinProducts.filter(p => 
            (p.rank && p.rank <= 7) || 
            (p.source === 'Clean Label Project')
        );
        
        // Filter based on user preferences
        if (quizData.proteinSource === 'plant') {
            // Only show OWYN for plant-based
            safeProducts = safeProducts.filter(p => p.brand === 'OWYN');
        } else if (quizData.proteinSource === 'whey') {
            // Exclude plant-based
            safeProducts = safeProducts.filter(p => p.brand !== 'OWYN');
        }
        
        // If they want mass gainer, prioritize those
        if (quizData.primaryUse === 'muscle') {
            const massGainers = safeProducts.filter(p => p.fullName.includes('Mass'));
            const others = safeProducts.filter(p => !p.fullName.includes('Mass'));
            safeProducts = [...massGainers, ...others];
        }
        
        // If they want budget, sort by price
        if (quizData.budget === 'budget' || quizData.concern === 'switch') {
            safeProducts.sort((a, b) => {
                const priceA = parseFloat(a.price.replace(/[^0-9.]/g, ''));
                const priceB = parseFloat(b.price.replace(/[^0-9.]/g, ''));
                return priceA - priceB;
            });
        }
        
        // If current product is in list, exclude it
        if (currentProduct) {
            safeProducts = safeProducts.filter(p => p.brand !== currentProduct.brand);
        }
        
        // Take top 5-6 recommendations
        const recommendations = safeProducts.slice(0, 6);
        
        recsDiv.innerHTML = recommendations.map(product => `
            <div class="rec-card">
                <div class="rec-header">
                    <h3>${product.fullName}</h3>
                    ${product.rank ? 
                        `<span class="rec-rank">#${product.rank}</span>` : 
                        `<span class="rec-rank">CLP</span>`
                    }
                </div>
                
                <div class="rec-details">
                    <div class="rec-detail">
                        <span class="rec-detail-label">Lead:</span>
                        <span class="rec-detail-value" style="color: #2ecc71;">${product.leadLevel}</span>
                    </div>
                    <div class="rec-detail">
                        <span class="rec-detail-label">Best for:</span>
                        <span class="rec-detail-value">${product.bestFor}</span>
                    </div>
                    <div class="rec-detail">
                        <span class="rec-detail-label">Price:</span>
                        <span class="rec-detail-value">${product.price}</span>
                    </div>
                </div>
                
                ${product.amazonLink ? `
                    <a href="${product.amazonLink}" target="_blank" rel="noopener" class="amazon-btn">
                        View on Amazon →
                    </a>
                ` : ''}
                
                ${product.articleLink ? `
                    <a href="${product.articleLink}" class="rec-article-link">Full Analysis</a>
                ` : ''}
            </div>
        `).join('');
    }

    function generateActionSteps(product) {
        const actionList = document.getElementById('action-list');
        
        if (!product) {
            // Unknown brand
            actionList.innerHTML = `
                <li><strong>Stop using your current protein powder</strong> until you can verify its safety with third-party testing</li>
                <li><strong>Check if your brand has certifications</strong> - Look for NSF Certified for Sport, Clean Label Project, or Informed Choice</li>
                <li><strong>Contact the manufacturer</strong> and request a Certificate of Analysis (COA) for heavy metals testing</li>
                <li><strong>Switch to a verified-safe option</strong> from the recommendations above</li>
                <li><strong>Read the full report</strong> to understand why independent testing matters</li>
            `;
        } else if ((product.rank && product.rank <= 7) || product.source === 'Clean Label Project') {
            // Safe product
            actionList.innerHTML = `
                <li><strong>Keep using ${product.brand}</strong> - It's verified safe for daily consumption</li>
                <li><strong>Continue your current serving size</strong> - No concerns with lead accumulation</li>
                ${product.articleLink ? `<li><strong>Read the detailed analysis</strong> to understand why it tested so well</li>` : ''}
                <li><strong>Share this information</strong> with friends and family using contaminated brands</li>
                <li><strong>Monitor news</strong> for any future testing updates on protein powders</li>
            `;
        } else if (product.rank && product.rank <= 19) {
            // Moderate contamination
            actionList.innerHTML = `
                <li><strong>Limit ${product.brand} to ${product.maxServings}</strong> as recommended by Consumer Reports</li>
                <li><strong>Strongly consider switching</strong> to a top-ranked safe alternative above</li>
                <li><strong>Do not use daily long-term</strong> - Lead accumulates in your body over time</li>
                <li><strong>Monitor for symptoms</strong> if you've been using daily: fatigue, brain fog, headaches, mood changes</li>
                <li><strong>Read the full report</strong> to understand the contamination levels</li>
            `;
        } else {
            // Dangerous contamination
            actionList.innerHTML = `
                <li><strong>STOP using ${product.brand} immediately</strong> - Lead levels are ${product.rank === 23 ? '15x' : '12x'} over safe limits</li>
                <li><strong>Do not finish the container</strong> - Even occasional use poses serious health risks</li>
                <li><strong>Switch to a verified-safe alternative</strong> from the recommendations above TODAY</li>
                <li><strong>Consider getting a blood lead test</strong> if you've been using daily for 6+ months - Ask your doctor</li>
                <li><strong>Watch for lead poisoning symptoms</strong>: chronic fatigue, brain fog, persistent headaches, irritability, difficulty concentrating</li>
                ${product.articleLink ? `<li><strong>Read the detailed analysis</strong> to understand the full severity of contamination</li>` : ''}
            `;
        }
    }

    // Track results page view
    if (typeof gtag !== 'undefined') {
        gtag('event', 'view_results', {
            'event_category': 'Quiz',
            'event_label': quizData.currentBrandName,
            'brand_safety': quizData.concernLevel
        });
    }
</script>
</body>
</html>
